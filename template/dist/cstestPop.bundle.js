(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1368:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n.n(a),s=n(0),i=n(50),o=n(66),c={props:{data:{type:Object,default:function(){return{}}},stars:{type:Array,default:function(){return[]}}},data:function(){return{sWord:null,selected:!1,isShowSkip:!0,rank:0,height:"auto"}},watch:{sWord:function(){setTimeout(this.reCalHeight)}},mounted:function(){this.reCalHeight()},methods:{reCalHeight:function(){setTimeout((function(){})),this.height="".concat(this.$refs.inner.clientHeight,"px")},tapStar:function(t,e){var n=this;n.rank=e+1,e<3?(n.sWord="".concat(t.word,"，请选择原因"),n.isShowSkip=!1):(n.sWord=t.word,n.selected&&(n.isShowSkip=!1)),n.$emit("tapStar",{index:e}),n.selected=!0},tapSkip:function(){this.$emit("tapSkip")}}},u=(n(946),n(29)),l=Object(u.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"stars",style:{height:t.height}},[n("div",{ref:"inner",staticClass:"star-inner"},[n("div",{staticClass:"star-wrap",class:{"star-wrap__selected":t.sWord&&t.rank<4}},t._l(t.stars,(function(e,a){return n("div",{key:e.word,staticClass:"star-item",on:{click:function(n){return t.tapStar(e,a)}}},[n("svg-icon",{staticClass:"star",class:{star__fill:e.selected},attrs:{name:"star"}}),t._v(" "),t.sWord?t._e():n("p",{staticClass:"start-text"},[t._v("\n          "+t._s(e.word)+"\n        ")])],1)})),0),t._v(" "),t.sWord?n("div",{staticClass:"tip",class:{gold:t.rank>3}},[t._v("\n      "+t._s(t.sWord)+"\n    ")]):t._e(),t._v(" "),t.isShowSkip?n("div",{staticClass:"skip",on:{click:t.tapSkip}},[t._v("\n      跳过评价\n    ")]):t._e()])])}),[],!1,null,"5343c333",null).exports;function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={mixins:[s.j],props:{data:{type:Object,default:function(){return{}}},reasons:{type:Array,default:function(){return[]}},rank:{type:Number,default:Number}},methods:{tapReason:function(t){this.$emit("tapReason",{index:t})},tapMore:function(t){var e=this;e.$emit("tapMore");var n=e.reasons.filter((function(t){return t.selected||t.jumpUrl})).map((function(t){return t.wording})).join("|");e.M_jump(Object.assign(t,{jumpUrl:e.M_composeUrl(t.jumpUrl,p({selected_items:n,templateId:e.data.templateId,rank:e.rank},s.b.getBase()))}))}}},d=(n(947),Object(u.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"heavy-links reasons"},t._l(t.reasons,(function(e,a){return n("div",{key:e.title,staticClass:"heavy-link",on:{click:function(e){return t.tapReason(a)}}},[e.jumpUrl?n("div",{staticClass:"heavy-link__inner reason__arrow with-arrow",on:{click:function(n){return t.tapMore(e)}}},[t._v("\n      "+t._s(e.wording)+"\n    ")]):n("div",{staticClass:"heavy-link__inner reason",class:{reason__selected:e.selected}},[t._v("\n      "+t._s(e.wording)+"\n    ")])])})),0)}),[],!1,null,"ff980322",null).exports),m=n(518),v=n(42),w=n(155);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y,_={components:{stars:l,reasons:d,heightAnimate:m.a},mixins:[s.j],data:function(){return Object.assign({asyncData:null,stars_:[],rank:0,reasons_:[],duration:0,firstClickStar:!0,isShowReason:!0,isShowReasonAndButton:!1,confirmed:!1,isPopShowing:!1},{startTime:+new Date})},computed:b(b({},Object(o.c)({requestId:function(t){return t.result.requestId||t.result.previousRid},resultObj:function(t){return t.result.self.resultObj}})),{},{templateContent:function(){return this.asyncData&&this.asyncData.templateContent||{}},pop:function(){return this.templateContent.pop||{}},header:function(){return{close:!0,title:this.pop.title}},stars:{get:function(){return this.stars_.length?this.stars_:this.pop.rank?this.pop.rank.map((function(t){return{word:t,selected:0}})):[]},set:function(t){this.stars_=t}},reasons:{get:function(){return this.reasons_.length?this.reasons_:this.pop.richReasons?this.pop.richReasons.map((function(t){return Object.assign({selected:0},t)})):[]},set:function(t){this.reasons_=t}}}),created:function(){var t=this;s.a.$on(s.g.newSearchArrived,(function(){setTimeout((function(){t.handleResultReady()}),0)})),i.b.onClientShadowClick((function(){t.isPopShowing&&t.hidePop().then((function(){t.asyncData=null}))}))},methods:{reset:function(){Object.assign(this.$data,{asyncData:null,stars_:[],rank:0,reasons_:[],duration:0,firstClickStar:!0,isShowReason:!0,isShowReasonAndButton:!1,confirmed:!1,isPopShowing:!1})},listenNavCtrl:(y=!1,function(){var t=this;y||w.a.on((function(e){t.handleClientNavAction(e)})),y=!0}),handleResultReady:function(){var t=this,e=t.resultObj.asyncFeedback;t.isPopShowing||(t.reset(),t.asyncData||e&&s.f.getCommonCgiData({cgiName:"GetSessionSurvey",data:b(b({},s.b.getBase()),{},{clientH5Version:s.b.version})}).then((function(e){var n=e.data;s.e.isObjectEmpty(n)||(n&&n.templateContent&&(t.asyncData=n),t.listenNavCtrl())})))},handleClientNavAction:function(t){var e=this;if(!e.isPopShowing)if(e.asyncData){e.duration=new Date-e.startTime;var n=e.pop.duration||3e3;e.duration<n?t():e.showPop()}else t()},showPop:function(){this.isPopShowing=!0,this.$refs._halfScreen.show(),s.f.showNavBarShadow({color:"#000000",alpha:.5,animateDuration:.3}),this.report({reportType:"expose",reasons:this.reasons.map((function(t){return t.wording}))})},hidePop:function(){var t=this;return new Promise((function(e){s.f.hideNavBarShadow({animateDuration:.3}),t.$refs._halfScreen.hide(),setTimeout((function(){e(),t.isPopShowing=!1}),300)}))},terminate:function(){var t=this;t.hidePop().then((function(){w.a.next(),t.asyncData=null}))},tapStar:function(t){var e=this,n=t.index;e.rank=n+1,e.stars=e.stars.map((function(t,e){return e<=n?Object.assign(t,{selected:1}):Object.assign(t,{selected:0})})),n<3?e.firstClickStar?e.isShowReasonAndButton=!0:e.isShowReason=!0:e.firstClickStar?setTimeout((function(){e.confirm()}),500):e.isShowReason=!1,e.firstClickStar=!1},tapReason:function(t){var e=t.index;this.reasons=this.reasons.map((function(t,n){return n==e?Object.assign(t,{selected:!t.selected}):t}))},tapMore:function(){var t=this;t.hidePop().then((function(){t.asyncData=null}))},confirm:function(){var t=this;t.confirmed=!0,t.report({duration:+new Date-t.startTime}),setTimeout((function(){t.terminate()}),300)},report:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this;s.f.getCommonCgiData({cgiName:v.a.reportInserData,data:Object.assign({reportType:"click",templateType:e.templateContent.type,reportLogId:18811,scene:s.b.scene,query:s.b.query,searchId:s.b.searchId,sessionId:s.b.sessionId,requestId:e.requestId,homepage:s.b.isHomePage,timestamp:+new Date,templateId:e.asyncData.templateId,rank:e.rank,reasons:e.rank>3?[]:e.reasons.filter((function(t){return t.selected})).map((function(t){return t.wording})),duration:0},t)})}}},S=(n(948),Object(u.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.asyncData&&t.asyncData.templateContent?n("div",[n("ui-half-screen",{ref:"_halfScreen",attrs:{"can-scroll":!0,header:t.header},on:{"tap:close":t.terminate,"tap:mask":t.terminate}},[n("div",{staticClass:"pop",class:{pop__confirm:t.confirmed}},[n("stars",{attrs:{data:t.asyncData,stars:t.stars},on:{tapStar:t.tapStar,tapSkip:t.terminate}}),t._v(" "),n("heightAnimate",{directives:[{name:"show",rawName:"v-show",value:t.isShowReasonAndButton,expression:"isShowReasonAndButton"}],staticClass:"wrap",attrs:{duration:300,name:"popWrap"}},[t.isShowReason?n("heightAnimate",{attrs:{duration:300,name:"popReason"}},[n("reasons",{staticClass:"reasons",attrs:{data:t.asyncData,reasons:t.reasons,rank:t.rank},on:{tapReason:t.tapReason,tapMore:t.tapMore}})],1):t._e(),t._v(" "),n("div",{staticClass:"btn-wrap"},[n("div",{staticClass:"weui-btn weui-btn_primary btn",on:{click:t.confirm}},[t._v("\n            提交\n          ")])])],1)],1),t._v(" "),t.confirmed?n("div",{staticClass:"feedback"},[n("svg-icon",{staticClass:"cs-feedback__tick",attrs:{name:"tick"}}),t._v(" "),n("div",{staticClass:"cs-feedback__text"},[t._v("\n        已提交\n      ")])],1):t._e()])],1):t._e()}),[],!1,null,"292d7efe",null));e.default=S.exports},518:function(t,e,n){"use strict";var a=n(123),r=n(0),s=n(5),i=r.e.getSupportProperty("transform"),o={props:{withoutEnter:{type:Boolean,default:!1},withoutLeave:{type:Boolean,default:!1},entered:{type:Function,default:function(){}},leaved:{type:Function,default:function(){}},duration:{type:Number,default:300},transfrom:{type:Boolean,default:!0}},data:function(){return{show:!1}},mounted:function(){this.show=!0},methods:{beforeEnter:function(){this.style={height:"0px"},r.a.$emit(s.b.heightAnimateStart)},enter:function(t,e){var n=this,r=n.$refs.inner,s=r.offsetHeight;n.withoutEnter?(t.height="".concat(s,"px"),e()):a.a.generateAnimate({duration:n.duration,update:function(e){return t.style.height="".concat(s*e,"px"),n.transfrom&&(r.style[i]="translate(0,".concat(100*e-100,"%)")),!0},finish:function(){e()}})},afterEnter:function(t){t.style.height="auto",this.entered(),r.a.$emit(s.b.heightAnimateEnd)},beforeLeave:function(){r.a.$emit(s.b.heightAnimateStart)},leave:function(t,e){var n=this,r=t.offsetHeight,s=n.$refs.inner;n.withoutLeave?(t.height="0px",e()):a.a.generateAnimate({duration:n.duration,update:function(e){return t.style.height="".concat(r-r*e,"px"),n.transfrom&&(s.style[i]="translate(0,".concat(-100*e,"%)")),!0},finish:function(){e()}})},afterLeave:function(){this.leaved(),r.a.$emit(s.b.heightAnimateEnd)}}},c=(n(529),n(29)),u=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"h-animate"},on:{"before-enter":t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[t.show?n("div",{staticClass:"h-animate"},[n("div",{ref:"inner",staticClass:"h-animate__inner"},[t._t("default")],2)]):t._e()])}),[],!1,null,null,null);e.a=u.exports},520:function(t,e,n){},527:function(t,e,n){},528:function(t,e,n){},529:function(t,e,n){"use strict";var a=n(520);n.n(a).a},530:function(t,e,n){},946:function(t,e,n){"use strict";var a=n(527);n.n(a).a},947:function(t,e,n){"use strict";var a=n(528);n.n(a).a},948:function(t,e,n){"use strict";var a=n(530);n.n(a).a}}]);