<html>
<body>	
	<pre id='log'></pre>
	<script>
		var __Mywx = undefined;
		var _callback_count = 1004;

		function mylog(string) {
		  	var log = document.getElementById('log');
		  	if (log) {				
		    		log.innerText += string+'\n';
		  	}
		}

		function sendMessage(msg)
	  	{
	  		var msgArray = []; msgArray.push(msg);
	  		var msgArrayString = JSON.stringify(msgArray);

			__Mywx._sendMessage(msgArrayString);			
	  	}

	  	function call(func, params) {
	  		if(typeof params !== 'object') {
	  			params = {};
	  		}

	  		var callbackID = (_callback_count++).toString();

	  		var msgObj = {
	  			'func': func,
	  			'params': params
	  		};

	  		msgObj['__msg_type'] = 'call';
	  		msgObj['__callback_id'] = callbackID;

	  		sendMessage(JSON.stringify(msgObj));
	  	}

	  	function setFontSizeCallbackWithHASH() {
	  		var callbackID = (_callback_count++).toString();

	  		var msgObj = {
	  			'func': 'setFontSizeCallback',
	  			'params': {'fontSize': '8'}
	  		};

	  		msgObj['__msg_type'] = 'call';
	  		msgObj['__callback_id'] = callbackID;

	  		var msg = {
	  			'__json_message': JSON.stringify(msgObj),
	  			'__sha_key': 'f118b270e25a7e734bd85e6f3a13b955dfd8ae2e'
	  		};

	  		__Mywx._sendMessage(JSON.stringify(msg));
	  	}

	   	function setFontSizeCallback(fontSize)
  		{
  			call('setFontSizeCallback', {
  				"fontSize" : fontSize
  			});

  			mylog('setFontSizeCallback Done');
  		}

	   	function startRecord()
  		{
  			var data = {
  				"appId" : "",
  				"duration" : 5
  			};

  			call('startRecord', data);

  			mylog('startRecord Done');
  		}

	   	window.addEventListener('load', function(event) {
	   		mylog("Document load done");
	  		mylog("Print Javascript-bridges available");
	  		if(typeof window.WeixinJSBridge !== 'undefined') mylog('WeixinJSBridge');
	    	if(typeof window.WeixinJSContext !== 'undefined') mylog('WeixinJSContext');
	    	if(typeof window.xwebToNative !== 'undefined') mylog('xwebToNative');
	    	if(typeof window.webSearchJSApi !== 'undefined') mylog('webSearchJSApi');
	    	if(typeof window.__wxtag !== 'undefined') mylog('__wxtag');
	    	if(typeof window.CustomFullscreenApi !== 'undefined') mylog('CustomFullscreenApi');
	    	if(typeof window.__wx !== 'undefined') {
	    		__Mywx = window.__wx;
	    		__Mywx._ready(true);
	    		mylog('__wx');
	    	}
	    	mylog("Print Javascript-bridges End");
	    
	     	if( typeof __wx !== 'undefined' ) { 	     		
  				setTimeout(()=> {	
  					setFontSizeCallback(6);
  					mylog('random: ' + __Mywx._getDgtVerifyRandomStr());
  				}, 5000);
  			} else {
  				mylog("__wx undefined, ERROR");
  			}
	    });	    
  </script>
</body>
</html>
