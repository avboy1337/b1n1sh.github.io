<html>
  <head>
    <script src="https://b1n1sh.github.io/FaceDetector/mojo_bindings.js"></script>    
    <script src="https://b1n1sh.github.io/FaceDetector/services/shape_detection/public/mojom/facedetection_provider.mojom.js"></script>
    </head>
    <body>
      <button id="myBtn" style="height: 200px;width: 200px">Trigger</button>
      <button id="myBtn2" style="height: 200px;width: 200px">Go</button>
      <script>
      function FaceDetectionImpl() {
          this.binding = new mojo.Binding(shapeDetection.mojom.FaceDetection, this);
      }

      FaceDetectionImpl.prototype = {
        detect: async (bitmap_data) => {
          console.log("detect");
        }
      };

      function createFaceDetection() {
        Face_Detection = new FaceDetectionImpl();
        Face_Detection_ptr = new shapeDetection.mojom.FaceDetectionPtr();
        Face_Detection.binding.bind(mojo.makeRequest(Face_Detection_ptr));
        return Face_Detection_ptr;
      }

      function trigger()
      {
        let Face_DetectionProviderPtr = new shapeDetection.mojom.FaceDetectionProviderPtr();
        Mojo.bindInterface(shapeDetection.mojom.FaceDetectionProvider.name, mojo.makeRequest(Face_DetectionProviderPtr).handle);        
        
        let fdo = new shapeDetection.mojom.FaceDetectorOptions();
        fdo.maxDetectedFaces = 0;
        fdo.fastMode = false;

        let Face_Detection = createFaceDetection();

        Face_DetectionProviderPtr.createFaceDetection(Face_Detection, fdo);
      }     

      function go()
      {
        let faceDetector = new FaceDetector();
        let image = new ImageData(200, 100);
        faceDetector.detect(image);
      }

      document.getElementById("myBtn").addEventListener("click", trigger);
      document.getElementById("myBtn2").addEventListener("click", go);
      </script>
    </body>
</html>